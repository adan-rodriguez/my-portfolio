<figure id="me">
  <img
    src="/images/adan-rodriguez.avif"
    alt="Foto de Adán Rodríguez"
    fetchpriority="high"
  />
</figure>

<script>
  const me = document.querySelector("#me") as HTMLElement;
  const width = me.clientWidth;
  const height = me.clientHeight;

  me.addEventListener("mousemove", (e) => {
    const { layerX, layerY } = e as MouseEvent;

    const yRotation = ((layerX - width / 2) / width) * 20;
    const xRotation = ((layerY - height / 2) / height) * 20;

    me.style.transform = `perspective(500px) rotateX(${-xRotation}deg) rotateY(${yRotation}deg)`;
  });

  me.addEventListener("mouseleave", () => {
    me.style.transform = "perspective(500px) rotateX(0) rotateY(0)";
  });
</script>

<style is:inline>
  #me {
    --size: 300px;

    width: var(--size);
    height: var(--size);
    position: relative;
    border-radius: 100%;
    background-image: radial-gradient(black 40%, var(--color-primary));
    mix-blend-mode: var(--mix-mode-me-img);
    box-shadow: 0 0 20px var(--color-primary);
    /* animation: move 4s linear infinite; */
    /* overflow: hidden; */
    transition: transform 0.15s;

    & img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      object-position: top;
      border-radius: 100%;
    }

    &::after {
      box-shadow: 0 -20px 20px var(--color-primary) inset;
      position: absolute;
      top: 0;
      width: 100%;
      height: 100%;
      border-radius: 100%;
      animation: shadow-inset 4s linear infinite;

      @keyframes shadow-inset {
        to {
          rotate: 360deg;
        }
      }

      @media (width >=640px) {
        content: "";
      }
    }

    &::before {
      content: "";
      position: absolute;
      width: 100%;
      height: 14px;
      background-image: radial-gradient(
        var(--color-primary) 0% 35%,
        transparent
      );
      bottom: -5rem;
      border-radius: 100%;
      filter: blur(15px);
      pointer-events: none;
    }

    /* @keyframes move {
      0% {
        transform: translateX(-10px) translateY(0px);
      }
      25% {
        transform: translateX(0px) translateY(10px);
      }
      50% {
        transform: translateX(10px) translateY(0px);
      }
      75% {
        transform: translateX(0px) translateY(-10px);
      }
      100% {
        transform: translateX(-10px) translateY(0px);
      }
    }

    @media (width >= 768px) {
      @keyframes move {
        0% {
          transform: translateX(-20px) translateY(0px);
        }
        25% {
          transform: translateX(-10px) translateY(10px);
        }
        50% {
          transform: translateX(0px) translateY(0px);
        }
        75% {
          transform: translateX(-10px) translateY(-10px);
        }
        100% {
          transform: translateX(-20px) translateY(0px);
        }
      }
    } */
  }
</style>
